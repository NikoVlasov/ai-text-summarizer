name: CI  # название workflow, будет видно на GitHub

on:               # когда запускать
  push:           # при каждом пуше в main
    branches: [ "main" ]
  pull_request:   # при PR в main
    branches: [ "main" ]

jobs:             # список задач
  build:          # наша задача = build
    runs-on: ubuntu-latest   # запускается в Linux-среде

    steps:        # шаги внутри задачи
    - name: Checkout repo   # скачиваем твой код
      uses: actions/checkout@v3

    - name: Set up Python   # ставим Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.10"

    - name: Install dependencies  # ставим зависимости
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: Lint with flake8      # проверка стиля кода
      run: |
        pip install flake8
        flake8 . --max-line-length=120

    - name: Run tests   # запуск тестов
      run: |
        pytest || echo "No tests yet"
